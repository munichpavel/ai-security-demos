MALWARE_LIST = [
    'dspy-ai',
    'wanna-cry',
    'gotcha',
    'openai-4'
]


def expert_detect_malware(source_code: str, dependencies: str) -> str:
    dependency_list = dependencies.split('\n')

    has_malware = False

    for a_dependency in dependency_list:
        print(f'Checking dependency `{a_dependency}` against malware list')
        for a_malware in MALWARE_LIST:
            if a_dependency.startswith(a_malware):
                has_malware = True


    result = 'infected' if has_malware else 'harmless'
    return result
